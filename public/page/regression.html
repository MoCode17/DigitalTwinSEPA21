<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Digital Twin Prototype</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""
     />
     <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin="">
    </script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
    rel="stylesheet">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js" integrity="sha512-7U4rRB8aGAHGVad3u2jiC7GA5/1YhQcQjxKeaVms/bT66i3LVBMRcBI9KwABNWnxOSwulkuSXxZLGuyfvo7V1A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">

    <link href="css/sidebar.css" rel="stylesheet">

    <link href="css/map.css" rel="stylesheet">

    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
   
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
  
    <script src='https://cdn.plot.ly/plotly-latest.min.js'></script>

    <py-env>
      - matplotlib
      - pandas
      - plotly
    </py-env>

  </head>
  
  <body id="body-pd">
    <header class="header" id="header">
      <div class="header_toggle">
        <i class="bx bx-menu" id="header-toggle"></i>
      </div>
      <div class="header_img">
      </div>
      <span id="clock"></span>
    </header>
    <div class="l-navbar" id="nav-bar">
      <nav class="nav">
        <div>
          <a href="/" class="nav_logo">
            <i class="bx bx-home-alt-2 nav_logo-icon"></i>
            <span class="nav_logo-name">Digital Twin</span>
          </a>
          <div class="nav_list">
            <a href="/index" class="nav_link">
              <i class="bx bxs-dashboard nav_icon"></i>
              <span class="nav_name">Dashboard</span>
            </a>
            <a href="/history" class="nav_link">
              <i class="bx bx-history nav_icon"></i>
              <span class="nav_name">Historical Data</span>
            </a>
            <a href="/regression" class="nav_link active">
              <i class="bx bx-line-chart nav_icon"></i>
              <span class="nav_name">Regression</span>
            </a>
          </div>
        </div>
        <a href="#" class="nav_link">
          <i class="bx bx-log-out nav_icon"></i>
          <span class="nav_name">Log Out</span>
        </a>
      </nav>
    </div>
    
    <div="container">
      <div class="row">
        <div class="col-sm-5 p-2 shadow ml-4 mr-4 mb-4 bg-white rounded">
            <div id="chart"></div>
        </div>
      </div>
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
    <script type="text/javascript" src="js/navbar.js"></script>
    <script type="text/javascript" src="js/clock.js"></script>
    <script type='text/javascript'>
      function plot(graph, chart) {
          var figure = JSON.parse(graph)
          Plotly.newPlot(chart, figure, {});
      }
     </script>
    <py-script>
        # Import libraries
        import pandas as pd
        import matplotlib.pyplot as plt
        import js
        import json
        import plotly
        import plotly.express as px

        ## Get the data
        from pyodide.http import open_url
        
        url = 'https://raw.githubusercontent.com/alanjones2/uk-historical-weather/main/data/Heathrow.csv'
        url_content = open_url(url)

        df = pd.read_csv(url_content)
        df = df[df['Year']==2020]

        def plot(chart):
            fig = px.line(df,
            x="Month", y=chart,
            width=800, height=400)
            graphJSON = json.dumps(fig, cls=plotly.utils.PlotlyJSONEncoder)
            js.plot(graphJSON,"chart")

        plot('Tmax')
    </py-script>
  </body>
</html>
